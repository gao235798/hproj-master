<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.espread.sys.mapper.POPomainMapper" >
  <resultMap id="BaseResultMap" type="com.espread.sys.model.POPomain" >
    <id column="POID" property="poid" jdbcType="INTEGER" />
    <result column="cPOID" property="cpoid" jdbcType="NVARCHAR" />
    <result column="dPODate" property="dpodate" jdbcType="TIMESTAMP" />
    <result column="cVenCode" property="cvencode" jdbcType="NVARCHAR" />
    <result column="cDepCode" property="cdepcode" jdbcType="NVARCHAR" />
    <result column="cPersonCode" property="cpersoncode" jdbcType="NVARCHAR" />
    <result column="cPTCode" property="cptcode" jdbcType="NVARCHAR" />
    <result column="cArrivalPlace" property="carrivalplace" jdbcType="NVARCHAR" />
    <result column="cSCCode" property="csccode" jdbcType="NVARCHAR" />
    <result column="cexch_name" property="cexchName" jdbcType="NVARCHAR" />
    <result column="nflat" property="nflat" jdbcType="DOUBLE" />
    <result column="iTaxRate" property="itaxrate" jdbcType="DOUBLE" />
    <result column="cPayCode" property="cpaycode" jdbcType="NVARCHAR" />
    <result column="iCost" property="icost" jdbcType="DECIMAL" />
    <result column="iBargain" property="ibargain" jdbcType="DECIMAL" />
    <result column="cMemo" property="cmemo" jdbcType="NVARCHAR" />
    <result column="cState" property="cstate" jdbcType="TINYINT" />
    <result column="cPeriod" property="cperiod" jdbcType="NVARCHAR" />
    <result column="cMaker" property="cmaker" jdbcType="NVARCHAR" />
    <result column="cVerifier" property="cverifier" jdbcType="NVARCHAR" />
    <result column="cCloser" property="ccloser" jdbcType="NVARCHAR" />
    <result column="cDefine1" property="cdefine1" jdbcType="NVARCHAR" />
    <result column="cDefine2" property="cdefine2" jdbcType="NVARCHAR" />
    <result column="cDefine3" property="cdefine3" jdbcType="NVARCHAR" />
    <result column="cDefine4" property="cdefine4" jdbcType="TIMESTAMP" />
    <result column="cDefine5" property="cdefine5" jdbcType="INTEGER" />
    <result column="cDefine6" property="cdefine6" jdbcType="TIMESTAMP" />
    <result column="cDefine7" property="cdefine7" jdbcType="DOUBLE" />
    <result column="cDefine8" property="cdefine8" jdbcType="NVARCHAR" />
    <result column="cDefine9" property="cdefine9" jdbcType="NVARCHAR" />
    <result column="cDefine10" property="cdefine10" jdbcType="NVARCHAR" />
    <result column="iVTid" property="ivtid" jdbcType="INTEGER" />
    <result column="cChanger" property="cchanger" jdbcType="NVARCHAR" />
    <result column="cBusType" property="cbustype" jdbcType="NVARCHAR" />
    <result column="cDefine11" property="cdefine11" jdbcType="NVARCHAR" />
    <result column="cDefine12" property="cdefine12" jdbcType="NVARCHAR" />
    <result column="cDefine13" property="cdefine13" jdbcType="NVARCHAR" />
    <result column="cDefine14" property="cdefine14" jdbcType="NVARCHAR" />
    <result column="cDefine15" property="cdefine15" jdbcType="INTEGER" />
    <result column="cDefine16" property="cdefine16" jdbcType="DOUBLE" />
    <result column="cLocker" property="clocker" jdbcType="NVARCHAR" />
    <result column="iDiscountTaxType" property="idiscounttaxtype" jdbcType="TINYINT" />
    <result column="iverifystateex" property="iverifystateex" jdbcType="INTEGER" />
    <result column="ireturncount" property="ireturncount" jdbcType="INTEGER" />
    <result column="IsWfControlled" property="iswfcontrolled" jdbcType="BIT" />
    <result column="cmaketime" property="cmaketime" jdbcType="TIMESTAMP" />
    <result column="cModifyTime" property="cmodifytime" jdbcType="TIMESTAMP" />
    <result column="cAuditTime" property="caudittime" jdbcType="TIMESTAMP" />
    <result column="cAuditDate" property="cauditdate" jdbcType="TIMESTAMP" />
    <result column="cModifyDate" property="cmodifydate" jdbcType="TIMESTAMP" />
    <result column="cReviser" property="creviser" jdbcType="NVARCHAR" />
    <result column="cVenPUOMProtocol" property="cvenpuomprotocol" jdbcType="NVARCHAR" />
    <result column="cChangVerifier" property="cchangverifier" jdbcType="NVARCHAR" />
    <result column="cChangAuditTime" property="cchangaudittime" jdbcType="TIMESTAMP" />
    <result column="cChangAuditDate" property="cchangauditdate" jdbcType="TIMESTAMP" />
    <result column="iBG_OverFlag" property="ibgOverflag" jdbcType="SMALLINT" />
    <result column="cBG_Auditor" property="cbgAuditor" jdbcType="NVARCHAR" />
    <result column="cBG_AuditTime" property="cbgAudittime" jdbcType="NVARCHAR" />
    <result column="ControlResult" property="controlresult" jdbcType="SMALLINT" />
    <result column="iflowid" property="iflowid" jdbcType="INTEGER" />
    <result column="iPrintCount" property="iprintcount" jdbcType="INTEGER" />
    <result column="dCloseDate" property="dclosedate" jdbcType="TIMESTAMP" />
    <result column="dCloseTime" property="dclosetime" jdbcType="TIMESTAMP" />
    <result column="ccleanver" property="ccleanver" jdbcType="NVARCHAR" />
    <result column="cContactCode" property="ccontactcode" jdbcType="NVARCHAR" />
    <result column="cVenPerson" property="cvenperson" jdbcType="NVARCHAR" />
    <result column="cVenBank" property="cvenbank" jdbcType="NVARCHAR" />
    <result column="cVenAccount" property="cvenaccount" jdbcType="NVARCHAR" />
    <result column="cappcode" property="cappcode" jdbcType="NVARCHAR" />
    <result column="csysbarcode" property="csysbarcode" jdbcType="NVARCHAR" />
    <result column="cCurrentAuditor" property="ccurrentauditor" jdbcType="NVARCHAR" />
    <result column="cGCRouteCode" property="cgcroutecode" jdbcType="NVARCHAR" />
    <result column="bGCTransforming" property="bgctransforming" jdbcType="BIT" />
  </resultMap>
  <resultMap id="ResultMapWithBLOBs" type="com.espread.sys.model.POPomain" extends="BaseResultMap" >
    <result column="ufts" property="ufts" jdbcType="BINARY" />
  </resultMap>
  <sql id="Base_Column_List" >
    a.POID, a.cPOID, a.dPODate, a.cVenCode, a.cDepCode, a.cPersonCode, a.cPTCode, a.cArrivalPlace, a.cSCCode,
     a.cexch_name, a.nflat, a.iTaxRate, a.cPayCode, a.iCost, a.iBargain, a.cMemo, a.cState, a.cPeriod, a.cMaker,
     a.cVerifier, a.cCloser, a.cDefine1, a.cDefine2, a.cDefine3, a.cDefine4, a.cDefine5, a.cDefine6, a.cDefine7, 
    a.cDefine8, a.cDefine9, a.cDefine10, a.iVTid, a.cChanger, a.cBusType, a.cDefine11, a.cDefine12, a.cDefine13, 
    a.cDefine14, a.cDefine15, a.cDefine16, a.cLocker, a.iDiscountTaxType, a.iverifystateex, a.ireturncount, 
    a.IsWfControlled, a.cmaketime, a.cModifyTime, a.cAuditTime, a.cAuditDate, a.cModifyDate, a.cReviser, 
    a.cVenPUOMProtocol, a.cChangVerifier, a.cChangAuditTime, a.cChangAuditDate, a.iBG_OverFlag, 
    a.cBG_Auditor, a.cBG_AuditTime, a.ControlResult, a.iflowid, a.iPrintCount, a.dCloseDate, a.dCloseTime, 
    a.ccleanver, a.cContactCode, a.cVenPerson, a.cVenBank, a.cVenAccount, a.cappcode, a.csysbarcode, 
    a.cCurrentAuditor, a.cGCRouteCode, a.bGCTransforming 
  </sql>
  <sql id="Blob_Column_List" >
    a.ufts
  </sql>
  <select id="selectByALLPOPomain" resultMap="ResultMapWithBLOBs" parameterType="java.lang.Integer" >
    select 
    <include refid="Base_Column_List" />
    ,
    <include refid="Blob_Column_List" />

       from PO_Pomain a ,PurchaseType b
     where  a.cPTCode= b.cPTCode  and  b.cptname like '%-LES%' AND  isnull(cVerifier,'')!=''  and isnull(cDefine8,'') =''    and isnull(cDefine9,'') =''
  </select>
  
  
  <select id="selectByALLPOPomainGb" resultMap="ResultMapWithBLOBs" parameterType="java.lang.Integer" >
    select  distinct  a.POID ,a.cPOID ,a.cCloser
      from PO_Pomain a, PO_Podetails b 
        where  a.POID =b.POID   and isnull(b.cbCloser,'') !=''  and isnull(b.cDefine24,'') =''
  </select>

  <select id="selectByALLPOPomainXs" resultMap="ResultMapWithBLOBs" parameterType="java.lang.Integer" >
    select
        POID,cVenCode,cPOID
    from PO_Pomain
--     where  cPOID ='202405070008'
    where   cVenCode = 021 and cDefine17 is null and cVerifier is not null
  </select>

  <select id="selectPOPomainByCustomers" resultMap="ResultMapWithBLOBs" parameterType="java.lang.Integer" >
    select
    <include refid="Base_Column_List"/>
    ,
    <include refid="Blob_Column_List"/>
    from
    where cVenCode = #{customer,jdbcType=NVARCHAR} and cDefine17 is null and cVerifier is not null
  </select>


  <update id="updatePOPomain"  >
    update PO_Pomain 
    	set  cDefine8 =#{cDefine8,jdbcType=NVARCHAR} 
    	where poid =   #{poid,jdbcType=INTEGER} 
    </update>
    
    <update id="updatePOPomainGb"  >
    update  b
    	set  b.cDefine24 =#{cDefine24,jdbcType=NVARCHAR} 
    	 from PO_Pomain a, PO_Podetails b 
        where  a.poid =   #{poid,jdbcType=INTEGER}  and a.POID =b.POID   and isnull(b.cbCloser,'') !=''  and isnull(b.cDefine24,'') =''  
    
    </update>

  <update id="updatePOPomainxs"  >
    update PO_Pomain
    set  cDefine17 =#{cDefine17,jdbcType=NVARCHAR},cDefine18 =#{cDefine18,jdbcType=NVARCHAR}
    where poid =   #{poid,jdbcType=INTEGER}
  </update>
  <select id="selectByCpoid" resultMap="BaseResultMap">
    select
    <include refid="Base_Column_List"/>
    from pO_pomain
    where
    cPOID = #{cpoid,jdbcType=VARCHAR}
  </select>

</mapper>